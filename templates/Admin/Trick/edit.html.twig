{% extends 'base.html.twig' %}

{% block body %}
    <div class="container">

        <h1>Editez le trick</h1>
        {{ include('Admin/Trick/_form.html.twig') }}
    {% spaceless %}
        {% for image in trick.images %}
        {% if image is not null %}
            <img class="card-img-top  " src="{{ asset('uploads/images/'~image.url) }}" alt="Card image cap">
            {% endif %}
            {% endfor %}
        {% endspaceless %}
    </div>
{% endblock %}
{% block javascript %}
    {{ parent() }}
    <script>
        jQuery(document).ready(function () {
            var $collectionHolder;

            var $addImageLink = $('<a href="#" class="add_image_link">Ajouter une image</a>');
            var $newLinkLi = $('<li></li>').append($addImageLink);

            var $collectionVideo;

            var $addVideoLink = $('<a href="#" class="add_video_link">Ajouter une video</a>');
            var $newLinkLi2 = $('<li></li>').append($addVideoLink);

            $collectionHolder = $('ul.images');

            $collectionHolder.append($newLinkLi);

            $collectionHolder.data('index', $collectionHolder.find(':input').length);

            $addImageLink.on('click', function (e) {
                e.preventDefault();

                addItemForm($collectionHolder, $newLinkLi);

            });

            function addItemForm($collectionHolder, $newLinkLi) {

                var prototype = $collectionHolder.data('prototype');

                var index = $collectionHolder.data('index');

                var newForm = prototype.replace(/__name__/g, index);

                $collectionHolder.data('index', index + 1);

                var $newFormLi = $('<li></li>').append(newForm);

                $newFormLi.append('<a href="#" class="remove-image">x</a>');

                $newLinkLi.before($newFormLi);

                $('.remove-image').click(function (e) {
                    e.preventDefault();
                    $(this).parent().remove();

                    return false

                })
            }


            $collectionVideo = $('ul.videos');

            $collectionVideo.append($newLinkLi2);

            $collectionVideo.data('index', $collectionVideo.find(':input').length);

            $addVideoLink.on('click', function (e) {
                e.preventDefault();

                addItemForm($collectionVideo, $newLinkLi2);

            });


        })
    </script>



{% endblock %}
